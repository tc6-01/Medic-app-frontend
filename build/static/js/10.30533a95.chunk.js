"use strict";(self.webpackChunkwebfile=self.webpackChunkwebfile||[]).push([[10],{6010:function(e,t,n){n.r(t),n.d(t,{default:function(){return g}});var r=n(9439),a=n(4554),u=n(3767),o=n(6598),c=n(2791),i=n(4142),s=n(3239),f=n(184),l=function(e){var t=e.loading,n=e.children;return t?(0,f.jsx)(s.Z,{sx:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)"}}):(0,f.jsx)(f.Fragment,{children:n})},p=n(1315),d=n(2479),h=function(e){var t=(0,c.useState)(null),n=(0,r.Z)(t,2),s=n[0],h=n[1],v=(0,c.useState)(!0),x=(0,r.Z)(v,2),Z=x[0],m=x[1],w=(0,c.useState)(1),g=(0,r.Z)(w,2),j=g[0],k=g[1],y=e.file;(0,c.useEffect)((function(){"owned"!==y.state&&"fromShared"!==y.state||console.log("no need to update"),(0,p.Sv)(y.fileName,y.state).then((function(e){var t=new Blob([e],{type:"application/pdf"}),n=new FileReader;n.readAsDataURL(t),n.addEventListener("load",(function(){var e=n.result;h(e.split(",")[1]),m(!1)}))}))}),[]);var S="data:application/pdf;base64,"+s;if(!s)return null;return s?(0,f.jsx)(l,{loading:Z,children:(0,f.jsx)(o.Z,{children:(0,f.jsxs)(u.Z,{spacing:1,alignContent:"center",pt:3,pb:3,children:[(0,f.jsx)(a.Z,{justifyContent:"center",display:"flex",children:"\u8fc7\u671f\u65f6\u95f4:".concat((0,d.u)(y.expire))}),(0,f.jsx)(a.Z,{justifyContent:"center",display:"flex",children:"\u5269\u4f59\u4f7f\u7528\u6b21\u6570:".concat(y.useLimit-y.use)}),(0,f.jsx)(a.Z,{justifyContent:"center",display:"flex",sx:{objectFit:"contain"},children:(0,f.jsx)(i.Z,{scale:.6,workerSrc:"pdf.worker.js",file:S,onDocumentComplete:function(e){k(e)},page:1})}),(0,f.jsx)(a.Z,{justifyContent:"center",display:"flex",children:"1"}),j>1&&function(e){for(var t=[],n=2;n<=e;n++)t.push((0,f.jsx)(a.Z,{justifyContent:"center",display:"flex",sx:{objectFit:"contain"},children:(0,f.jsx)(i.Z,{workerSrc:"pdf.worker.js",page:n,scale:.8,file:S},"x".concat(n))},n)),t.push((0,f.jsx)(a.Z,{justifyContent:"center",display:"flex",children:n},"c".concat(n)));return t}(j)]})})}):null},v=n(4005),x=n(8830),Z=n(1914),m=n(1948),w=n(6871),g=function(){var e=(0,w.TH)().state;return document.querySelector('meta[name="viewport"]').setAttribute("content","width=device-width, initial-scale=1.0"),(0,f.jsx)(v.zt,{of:Z.v,memo:!0,children:(0,f.jsx)(v.zt,{of:x.c,memo:!0,children:(0,f.jsx)(v.zt,{of:m.P,memo:!0,children:(0,f.jsx)(h,{file:e})})})})}},1315:function(e,t,n){n.d(t,{RX:function(){return c},SN:function(){return Z},Sv:function(){return v},cT:function(){return x},fD:function(){return f},lE:function(){return l},u5:function(){return p},v3:function(){return d},x4:function(){return i},z2:function(){return s},zU:function(){return h}});var r=n(4165),a=n(5861),u=n(4569),o=n.n(u);function c(e,t){var n=localStorage.getItem("username");return{id:e,fileName:t.fileName,size:t.fileSize,state:n==t.target?"owned":"fromShared",owner:t.target,isAllow:t.isAllow,use:t.use,useLimit:t.useLimit,expire:t.expire}}var i=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o().post("/user/login",{username:t,password:n});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),s=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n,a){var u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o().post("/user/register",{username:t,password:n,retry_password:a});case 2:return u=e.sent,e.abrupt("return",u.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),f=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o().get("/file/list",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o().get("/user/list",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("\u8bf7\u6c42\u53c2\u6570",t),e.next=3,o().post("/user/share",t,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o().get("/file/share",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o().get("/file/be-share",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o().get("/file/download?filename=".concat(t,"&state=").concat(n),{responseType:"blob",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),x=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o().post("/admin/upload",t,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o().get("/file/shareDelete?id=".concat(t),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},1948:function(e,t,n){n.d(t,{P:function(){return s}});var r=n(1413),a=n(9439),u=n(2791),o=n(4005),c=n(8830),i=n(1914);function s(){var e=(0,o.oR)(i.v),t=(0,o.oR)(c.c),n=(0,u.useState)([]),s=(0,a.Z)(n,2),f=s[0],l=s[1],p=(0,u.useState)(!1),d=(0,a.Z)(p,2),h=d[0],v=d[1],x=(0,u.useState)(!1),Z=(0,a.Z)(x,2),m=Z[0],w=Z[1];return(0,r.Z)((0,r.Z)((0,r.Z)({},e),t),{},{rows:f,setRows:l,editorDialogOpen:h,setEditorDialogOpen:v,updateDialogOpen:m,setUpdateDialogOpen:w})}},2479:function(e,t,n){function r(e){return new Date(e).toLocaleString()}n.d(t,{u:function(){return r}})}}]);
//# sourceMappingURL=10.30533a95.chunk.js.map