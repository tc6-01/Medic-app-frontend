{"version":3,"file":"static/js/297.a24e061a.chunk.js","mappings":"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","sources":["components/common/FileList/index.tsx","components/file-manage/FileOperationMenu/index.tsx","../node_modules/@material-ui/icons/esm/FileCopy.js","components/file-manage/index.tsx","pages/file-manage/index.tsx","styles/NoUserSelect.ts"],"sourcesContent":["import { sizeToString } from 'src/utils/sizeToString';\r\nimport { toLocalTimeString } from 'src/utils/time';\r\nimport { FileListProps } from '../../../types/ComponentProps';\r\nimport FileItem from \"../FileItem\";\r\nimport FileState from '../FileState';\r\nimport VerticalList from \"../VerticalList\";\r\n\r\n\r\nconst FileList = ({ items, onOperationClicked }: FileListProps) => {\r\n    return (\r\n        <VerticalList items={\r\n            items.map((item, index) => {\r\n                return <FileItem key={index}\r\n                    fileName={item.name}\r\n                    fileSize={sizeToString(item.size)}\r\n                    fileTime={toLocalTimeString(item.expire)}\r\n                    remainUse={item.useLimit - item.use}\r\n                    sharedContent={<FileState state={item.state} />}\r\n                    onOperationClicked={() => onOperationClicked(index)}\r\n                />\r\n            })\r\n        } />\r\n    )\r\n\r\n}\r\n\r\n\r\nexport default FileList\r\n","import { Delete, ErrorOutline, Share } from '@material-ui/icons';\r\nimport { Box, Stack } from '@mui/material';\r\nimport { FolderArrowUp } from 'mdi-material-ui';\r\nimport OperationItem from 'src/components/common/OperationItem';\r\nimport Section from 'src/components/common/Section';\r\nimport SimpleFileItem from 'src/components/common/SimpleFileItem';\r\nimport VerticalList from 'src/components/common/VerticalList';\r\nimport { FileOperationMenuProps } from '../../../types/ComponentProps';\r\n\r\n\r\n\r\nconst FileOperationMenu = ({ fileName, onOperationClicked }: FileOperationMenuProps) => {\r\n    return (\r\n        <Stack m={1}>\r\n            <Box borderRadius={3}>\r\n                <SimpleFileItem fileName={fileName} />\r\n                <Section title='文件操作'>\r\n                    <VerticalList items={[\r\n                        <OperationItem icon={<FolderArrowUp fontSize='large' />} name={'打开'} onclick={() => onOperationClicked('open')} />,\r\n                        <OperationItem icon={<Share fontSize='large' />} name={'共享'} onclick={() => onOperationClicked('share')} />,\r\n                        <OperationItem icon={<Delete fontSize='large' />} name={'删除'} onclick={() => onOperationClicked('delete')} />\r\n                    ]} />\r\n                </Section>\r\n                <Section title='更多操作'>\r\n                    <VerticalList items={[\r\n                        <OperationItem icon={<ErrorOutline fontSize='large' />} name={'详细信息'} onclick={() => onOperationClicked('detail')} />\r\n                    ]} />\r\n                </Section>\r\n            </Box>\r\n\r\n        </Stack>\r\n    )\r\n\r\n}\r\n\r\n\r\nexport default FileOperationMenu\r\n","import * as React from 'react';\nimport createSvgIcon from './utils/createSvgIcon';\nexport default createSvgIcon( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z\"\n}), 'FileCopy');","import { BottomDrawerStore } from \"src/states/global/BottomDrawerStore\";\r\nimport { FileItemData, FileManageOperationType, SpeedDialMenuOptionProps } from \"src/types/ComponentProps\";\r\nimport { Fade, Stack, Zoom } from \"@mui/material\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useStore, Provider } from \"reto\";\r\nimport FileList from 'src/components/common/FileList';\r\nimport Section from \"../common/Section\";\r\nimport FileOperationMenu from \"./FileOperationMenu\";\r\nimport { noUserSelect } from \"src/styles/NoUserSelect\";\r\nimport SpeedDialMenu from \"../common/PopMenu\";\r\nimport { Favorite, FileCopy, Print, Save, Share } from \"@material-ui/icons\";\r\nimport { BookOutline } from \"mdi-material-ui\";\r\nimport { useNavigate } from \"react-router\";\r\nimport { bool } from \"prop-types\";\r\nimport { getFileList } from \"src/service/medic\"\r\nconst FileManageWrapper = () => {\r\n    const bottomeDrawerStates = useStore(BottomDrawerStore)\r\n    const navi = useNavigate()\r\n    const actions: SpeedDialMenuOptionProps[] = [\r\n        { icon: <FileCopy fontSize=\"large\" />, name: '新建共享资源', onClick: () => { navi('/filemanage/create') } },\r\n        { icon: <BookOutline fontSize=\"large\" />, name: '添加策略', onClick: () => { navi('/policymanage/create') } },\r\n    ];\r\n    const [files, setFiles] = useState<FileItemData[]>([]);\r\n    // 使用 useEffect 来在组件挂载后获取数据\r\n    useEffect(() => {\r\n        // 获取文件数据\r\n        getFileList().then((res) => {\r\n            console.log(res)\r\n            setFiles(res.data.map((item, idx) => {\r\n                const owner = localStorage.getItem('username')\r\n                return {\r\n                    id: idx,\r\n                    name: item.fileName,\r\n                    size: item.fileSize,\r\n                    state: owner == item.owner ? 'owned' : 'fromShared',\r\n                    owner: item.owner,\r\n                    use: item.use,\r\n                    useLimit: item.useLimit,\r\n                    expire: item.expire\r\n                }\r\n            }))\r\n        })\r\n    }, []); // 空依赖数组意味着这个 useEffect 只会在组件挂载后执行一次\r\n\r\n    const handleFileOperation = (ty: FileManageOperationType, index: number) => {\r\n        console.log(files[index]);\r\n        switch (ty) {\r\n            case 'delete':\r\n                console.log('delete files at index', index);\r\n                break;\r\n            case 'open':\r\n                bottomeDrawerStates.setBottomDrawerOpen(false)\r\n\r\n                navi('/pdfpreview', { state: files[index] })//传入Id值\r\n                break;\r\n            case 'share':\r\n                bottomeDrawerStates.setBottomDrawerOpen(false)\r\n                navi('/policymanage/create', { state: { id: files[index].name } })//传入Id值\r\n                break;\r\n            case 'detail':\r\n                console.log('detail files at index', index);\r\n                break;\r\n        }\r\n    }\r\n\r\n    const onOperationClickHandler = (index: number) => {\r\n        bottomeDrawerStates.setBottomDrawerOpen(true)\r\n        bottomeDrawerStates.setBottomDrawerContent(\r\n            <FileOperationMenu fileName={files[index].name} onOperationClicked={(ty) => handleFileOperation(ty, index)} />\r\n        )\r\n    }\r\n    const noSelect = noUserSelect()\r\n    return (\r\n        <Fade in={true}>\r\n            <Stack className={noSelect.root}>\r\n                <Section title={'所有文件'}>\r\n                    <FileList items={files} onOperationClicked={onOperationClickHandler} />\r\n                </Section>\r\n                {/* <SpeedDialMenu options={actions} /> */}\r\n            </Stack>\r\n        </Fade>\r\n    )\r\n}\r\nexport default FileManageWrapper\r\n","// ** MUI Imports\r\n// ** Icons Imports\r\n// ** Demo Components Imports\r\nimport FileManageWrapper from 'src/components/file-manage';\r\nimport { Provider } from 'reto';\r\nimport { BottomDrawerStore } from 'src/states/global/BottomDrawerStore';\r\nimport { Zoom } from '@mui/material';\r\n\r\n\r\nconst FileManagePage = () => {\r\n  return <FileManageWrapper />\r\n}\r\n\r\nexport default FileManagePage\r\n","import { makeStyles } from \"@material-ui/core\";\r\n\r\nexport const noUserSelect = makeStyles({\r\n    root: {\r\n        '& > *': { userSelect: 'none' }\r\n    }\r\n})\r\n"],"names":["items","onOperationClicked","VerticalList","map","item","index","FileItem","fileName","name","fileSize","sizeToString","size","fileTime","toLocalTimeString","expire","remainUse","useLimit","use","sharedContent","FileState","state","Stack","m","Box","borderRadius","SimpleFileItem","Section","title","OperationItem","icon","FolderArrowUp","fontSize","onclick","Share","Delete","ErrorOutline","createSvgIcon","React","d","bottomeDrawerStates","useStore","BottomDrawerStore","navi","useNavigate","BookOutline","useState","files","setFiles","useEffect","getFileList","then","res","console","log","data","idx","owner","localStorage","getItem","id","noSelect","noUserSelect","Fade","in","className","root","setBottomDrawerOpen","setBottomDrawerContent","ty","handleFileOperation","makeStyles","userSelect"],"sourceRoot":""}