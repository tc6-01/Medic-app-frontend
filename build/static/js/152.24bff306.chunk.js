"use strict";(self.webpackChunkwebfile=self.webpackChunkwebfile||[]).push([[152],{8152:function(e,i,n){n.r(i),n.d(i,{default:function(){return B}});var t=n(4005),s=n(627),r=n(4554),a=n(2791),l=n(6871),o=n(3456),f=n(1413),c=n(9439),u=n(8830),d=n(1914);function m(){var e=(0,t.oR)(d.v),i=(0,t.oR)(u.c),n=(0,a.useState)([]),s=(0,c.Z)(n,2),r=s[0],l=s[1];return(0,f.Z)((0,f.Z)((0,f.Z)({},e),i),{},{files:r,setFiles:l})}var x=n(8953),Z=n(2639),p=n(9505),j=n(3857),h=n(3195),w=n(3767),g=n(9377),k=n(1186),v=n(7442),b=n(4350),z=n(184),N=function(e){var i=e.fileName,n=e.onOperationClicked;return(0,z.jsx)(w.Z,{m:1,children:(0,z.jsxs)(r.Z,{borderRadius:3,children:[(0,z.jsx)(b.Z,{fileName:i}),(0,z.jsx)(v.Z,{title:"\u6587\u4ef6\u64cd\u4f5c",children:(0,z.jsx)(p.Z,{items:[(0,z.jsx)(k.Z,{icon:(0,z.jsx)(g.Z,{fontSize:"large"}),name:"\u6253\u5f00",onclick:function(){return n("open")}}),(0,z.jsx)(k.Z,{icon:(0,z.jsx)(j.Z,{fontSize:"large"}),name:"\u5171\u4eab",onclick:function(){return n("share")}})]})}),(0,z.jsx)(v.Z,{title:"\u66f4\u591a\u64cd\u4f5c",children:(0,z.jsx)(p.Z,{items:[(0,z.jsx)(k.Z,{icon:(0,z.jsx)(h.Z,{fontSize:"large"}),name:"\u8be6\u7ec6\u4fe1\u606f",onclick:function(){return n("detail")}})]})})]})})},S=n(1315),C=n(2479),D=n(2001),O=n(7090),A=function(){var e,i=(0,l.s0)(),n=(0,t.oR)(m),f=(0,t.oR)(x.i);(0,a.useEffect)((function(){(0,S.zU)().then((function(e){e&&200===e.code&&(Array.isArray(e.data)?(n.setFiles(e.data.map((function(e,i){return{id:e.id,fileName:e.fileName,fileSize:e.fileSize,state:"shared",from:e.from,use:e.use,useLimit:e.useLimit,expire:e.expire,isAllow:e.isAllow}}))),n.setLoading(!1)):n.setFiles([e.data]))}))}),[]);var c=function(e){var t=n.files[e].useLimit-n.files[e].use;console.log("\u6587\u4ef6\u8fc7\u671f\u65f6\u95f4",n.files[e].expire),console.log("\u5f53\u524d\u65f6\u95f4",(new Date).getTime()),n.files[e].expire<(new Date).getTime()?O.Z.warning("\u8be5\u6587\u4ef6\u5df2\u8fc7\u671f\uff0c\u8bf7\u8054\u7cfb\u75c5\u5386\u62e5\u6709\u8005"):t<=0?O.Z.warning("\u8be5\u6587\u4ef6\u5df2\u88ab\u4f7f\u7528\u5b8c\u6bd5\uff0c\u8bf7\u8054\u7cfb\u6587\u4ef6\u62e5\u6709\u8005"):(f.setBottomDrawerOpen(!0),f.setBottomDrawerContent((0,z.jsx)(N,{fileName:n.files[e].fileName,onOperationClicked:function(t){return function(e,t){switch(e){case"delete":console.log("delete files at index",t);break;case"open":f.setBottomDrawerOpen(!1),console.log(n.files),i("/pdfpreview",{state:n.files[t]});break;case"share":if(console.log("share files at index",t),f.setBottomDrawerOpen(!1),1!=n.files[t].isAllow){O.Z.warning("\u5f53\u524d\u75c5\u5386\u5e76\u672a\u5206\u914d\u5171\u4eab\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u5171\u4eab\u6765\u6e90\u7528\u6237");break}i("/policymanage/create",{state:n.files[t]});break;case"detail":f.setBottomDrawerOpen(!1),i("/fileshare/details",{state:n.files[t]})}}(t,e)}})))};return(0,z.jsx)(s.Z,{in:!0,children:(0,z.jsx)(r.Z,{children:(0,z.jsx)(p.Z,{items:null===(e=n.files)||void 0===e?void 0:e.map((function(e,i){return(0,z.jsx)(Z.Z,{fileName:e.fileName,fileTime:(0,C.u)(e.expire),fileSize:(0,D.N)(e.fileSize),remainUse:e.useLimit-e.use,sharedContent:(0,z.jsx)(o.Z,{state:"fromShared"}),onOperationClicked:function(){return c(i)}},i)})),onItemClicked:c})})})},B=function(){return(0,z.jsx)(t.zt,{of:m,children:(0,z.jsx)(A,{})})}}}]);
//# sourceMappingURL=152.24bff306.chunk.js.map