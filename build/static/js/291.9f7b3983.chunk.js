"use strict";(self.webpackChunkwebfile=self.webpackChunkwebfile||[]).push([[291],{7006:function(e,t,n){n.d(t,{lq:function(){return h},D_:function(){return m},oi:function(){return f}});var r=n(8550),a=n(8096),o=n(4925),i=n(5594),u=n(5022),c=n(6934),l=n(9955),s=n(5523),d=(n(2791),n(184)),p=n(4454),f=function(e){var t=e.id,n=e.name,a=e.defaultValue,o=e.placeHolder,i=e.onChange;return(0,d.jsx)(r.Z,{id:t,fullWidth:!0,label:n,placeholder:o,defaultValue:a,onChange:i})},h=function(e){var t=e.id,n=e.name,r=e.options,c=e.defaultValue,l=e.placeHolder,s=e.onChange;return(0,d.jsxs)(a.Z,{fullWidth:!0,children:[(0,d.jsx)(o.Z,{id:"form-layouts-separator-select-label",children:n}),(0,d.jsx)(i.Z,{id:t,label:n,defaultValue:c,placeholder:l,labelId:"form-layouts-separator-select-label",onChange:s,children:r.map((function(e,t){return(0,d.jsx)(u.Z,{value:e.id,children:e.name},t)}))})]})},m=((0,c.ZP)(l.Z)((function(e){var t=e.theme;return{padding:8,"& .MuiSwitch-track":{borderRadius:11,"&:before, &:after":{content:'""',position:"absolute",top:"50%",transform:"translateY(-50%)",width:16,height:16},"&:before":{backgroundImage:'url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 24 24"><path fill="'.concat(encodeURIComponent(t.palette.getContrastText(t.palette.primary.main)),'" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg>\')'),left:12},"&:after":{backgroundImage:'url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 24 24"><path fill="'.concat(encodeURIComponent(t.palette.getContrastText(t.palette.primary.main)),'" d="M19,13H5V11H19V13Z" /></svg>\')'),right:12}},"& .MuiSwitch-thumb":{boxShadow:"none",width:16,height:16,margin:2}}})),function(e){var t=e.id,n=e.name,r=e.onChange,a=e.checked;return(0,d.jsx)(s.Z,{id:t,control:(0,d.jsx)(p.Z,{defaultChecked:!0}),label:n,labelPlacement:"start",checked:a,onChange:r})})},7090:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(9439),a=n(2791),o=n(5646),i=n(9658),u=n(184),c=function(e){var t=e.content,n=e.duration,c=void 0===n?3e3:n,l=e.type,s=a.useState(!0),d=(0,r.Z)(s,2),p=d[0],f=d[1],h=function(){f(!1)};return(0,u.jsx)(o.Z,{open:p,autoHideDuration:c,anchorOrigin:{vertical:"top",horizontal:"center"},onClose:h,children:(0,u.jsx)(i.Z,{onClose:h,severity:l,children:t})})},l=n(4164),s={success:function(e,t){var n=document.createElement("div"),r=(0,u.jsx)(c,{content:e,duration:t,type:"success"});l.render(r,n),document.body.appendChild(n)},error:function(e,t){var n=document.createElement("div"),r=(0,u.jsx)(c,{content:e,duration:t,type:"error"});l.render(r,n),document.body.appendChild(n)},warning:function(e,t){var n=document.createElement("div"),r=(0,u.jsx)(c,{content:e,duration:t,type:"warning"});l.render(r,n),document.body.appendChild(n)},info:function(e,t){var n=document.createElement("div"),r=(0,u.jsx)(c,{content:e,duration:t,type:"info"});l.render(r,n),document.body.appendChild(n)}}},4291:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var r=n(9439),a=n(6459),o=n(627),i=n(3767),u=n(6151),c=n(4005),l=n(7090),s=n(4030),d=n(1413),p=n(1889),f=n(8550),h=n(890),m=n(3241),g=n(1562),v=n(6571),x=n(7006),w=n(184),Z=function(e){var t=e.items;return(0,w.jsx)(p.ZP,{container:!0,direction:"row",children:t.map((function(e,t){return(0,w.jsx)(p.ZP,{item:!0,xs:6,children:(0,w.jsx)(x.D_,{id:e.id,name:e.name,enabled:e.enabled,checked:e.checked,onChange:e.onChange},t)})}))})},y=function(e){var t=e.items;return(0,w.jsx)(i.Z,{spacing:3,children:null===t||void 0===t?void 0:t.map((function(e,t){switch(e.type){case"text":var n=e.value;return(0,w.jsx)(p.ZP,{item:!0,display:e.display?"block":"none",children:(0,w.jsx)(x.oi,{id:n.id,name:n.name,defaultValue:n.defaultValue,placeHolder:n.placeHolder,onChange:n.onChange},t)},t);case"select":var r=e.value;return(0,w.jsx)(p.ZP,{item:!0,display:e.display?"block":"none",children:(0,w.jsx)(x.lq,{id:r.id,name:r.name,options:r.options,defaultValue:r.defaultValue,placeHolder:r.placeHolder,onChange:r.onChange},t)},t);case"title":return(0,w.jsx)(i.Z,{children:(0,w.jsx)(h.Z,{variant:"h4",color:"textPrimary",children:"\u6dfb\u52a0\u89c4\u5219"})},t);case"control":var a=e.value;return(0,w.jsx)(Z,{items:a.items});case"time":var o=e.value;return(0,w.jsx)(i.Z,{direction:"column",display:e.display?"flex":"none",children:(0,w.jsx)(v._,{dateAdapter:m.H,children:(0,w.jsx)(g.x,{label:o.title,value:o.value,onChange:o.onChange,renderInput:function(e){return(0,w.jsx)(f.Z,(0,d.Z)({},e))}})})},t);default:return(0,w.jsx)(w.Fragment,{})}}))})},b=n(6871),k=n(1315),C=n(2791),j=function(e){(0,a.Z)(e);var t=(0,c.oR)(s.N),n=(0,b.s0)(),d=(0,b.TH)().state,p=(0,C.useState)([]),f=(0,r.Z)(p,2),h=f[0],m=f[1];(0,C.useEffect)((function(){(0,k.lE)().then((function(e){e&&200===e.code?Array.isArray(e.data)&&m(e.data.map((function(e,t){return{id:t.toString(),name:e}}))):l.Z.error("\u83b7\u53d6\u7528\u6237\u5217\u8868\u5931\u8d25")})),t.setTo(new Date)}),[]);var g=function(e){switch(e.target.id){case"policyName":t.setPolicyName(e.target.value);break;case"des":t.setDes(e.target.value);break;case"count":t.setCount(parseInt(e.target.value));break;case"role":t.setRole(e.target.value);break;case"allow":t.setAllow(parseInt(e.target.value))}},v={items:[{type:"text",display:!0,value:{id:"policyName",name:"\u7b56\u7565\u540d\u79f0",defaultValue:t.policyName,placeHolder:"\u8bf7\u8f93\u5165\u5171\u4eab\u7b56\u7565\u540d\u79f0",onChange:g}},{type:"text",display:!0,value:{id:"des",name:"\u7b56\u7565\u63cf\u8ff0",defaultValue:t.des,placeHolder:"\u8bf7\u8f93\u5165\u5171\u4eab\u63cf\u8ff0",onChange:g}},{type:"title"},{type:"control",value:{items:[{name:"\u9650\u5236\u4f7f\u7528\u6b21\u6570",enabled:!0,checked:t.countDisplay,onChange:function(e){t.setCountDisplay(e.target.checked)}},{name:"\u9650\u5236\u4f7f\u7528\u65f6\u95f4",enabled:!0,checked:t.timeDisplay,onChange:function(e){t.setTimeDisplay(e.target.checked)}},{name:"\u9650\u5236\u540e\u7eed\u4f20\u64ad\u5171\u4eab",enabled:!0,checked:t.allowDisplay,onChange:function(e){t.setAllowDisplay(e.target.checked)}}]}},{type:"select",display:!0,value:{id:"role",name:"\u5171\u4eab\u81f3",placeHolder:"\u8bf7\u9009\u62e9\u5171\u4eab\u7528\u6237",defaultValue:t.role,options:h,onChange:function(e){t.setRole(e.target.value)}}},{type:"text",display:t.countDisplay,value:{id:"count",name:"\u7528\u6237\u53ef\u8bbf\u95ee\u6b21\u6570",defaultValue:t.count.toString(),placeHolder:"\u8bf7\u8f93\u5165\u7528\u6237\u53ef\u8bbf\u95ee\u6b21\u6570",onChange:g}},{type:"time",display:t.timeDisplay,value:{id:"to",value:t.to,title:"\u5171\u4eab\u7ed3\u675f\u65f6\u95f4",defaultValue:t.to.toString(),onChange:function(e){t.setTo(e)}}},{type:"text",display:t.allowDisplay,value:{id:"allow",name:"\u7528\u6237\u662f\u5426\u53ef\u4ee5\u5171\u4eab",defaultValue:t.isAllow.toString(),placeHolder:"\u5982\u679c\u8d4b\u4e88\u6743\u9650\u8bf7\u586b1\uff0c\u5426\u5219\u4e3a0",onChange:g}}]};return(0,w.jsx)(o.Z,{in:!0,children:(0,w.jsxs)(i.Z,{mt:2,mb:2,spacing:4,children:[(0,w.jsx)(y,{items:v.items}),(0,w.jsx)(u.Z,{fullWidth:!0,variant:"contained",sx:{minHeight:50},onClick:function(){0!=t.policyName.length?0!=t.des.length?(0==t.role.length&&l.Z.warning("\u5171\u4eab\u76ee\u6807\u7528\u6237\u4e0d\u80fd\u4e3a\u7a7a"),t.to.getTime()>d.expire?l.Z.warning("\u5171\u4eab\u7ed3\u675f\u65f6\u95f4\u4e0d\u80fd\u8d85\u8fc7\u75c5\u5386\u8fc7\u671f\u65f6\u95f4\uff01"):t.count>d.useLimit-d.use?l.Z.warning("\u75c5\u5386\u53ef\u8bbf\u95ee\u6b21\u6570\u5171\u4eab\u6b21\u6570\u4e0d\u80fd\u8d85\u8fc7\u5269\u4f59\u6b21\u6570\uff01"):(console.log(d),(0,k.u5)({fileName:d.fileName,target:h[t.role].name,expire:t.to.getTime(),useLimit:t.count,name:t.policyName,desc:t.des,isAllow:t.isAllow,state:d.state}).then((function(e){200==e.code?(l.Z.success("\u75c5\u5386\u5171\u4eab\u6210\u529f"),n("/filemanage")):(console.log(e),l.Z.error("\u8bf7\u6c42\u5931\u8d25 "+e.msg))})).catch((function(e){l.Z.error("\u9519\u8bef"+e)})))):l.Z.warning("\u63cf\u8ff0\u4e0d\u80fd\u4e3a\u7a7a\uff01"):l.Z.warning("\u7b56\u7565\u540d\u4e0d\u80fd\u4e3a\u7a7a")},children:"\u786e\u8ba4\u6dfb\u52a0"})]})})},S=function(){return(0,w.jsx)(j,{})}},1315:function(e,t,n){n.d(t,{RX:function(){return u},SN:function(){return v},Sv:function(){return m},cT:function(){return g},fD:function(){return s},lE:function(){return d},u5:function(){return p},v3:function(){return f},x4:function(){return c},z2:function(){return l},zU:function(){return h}});var r=n(4165),a=n(5861),o=n(4569),i=n.n(o);function u(e,t){var n=localStorage.getItem("username");return{id:e,fileName:t.fileName,size:t.fileSize,state:n==t.target?"owned":"fromShared",owner:t.target,isAllow:t.isAllow,use:t.use,useLimit:t.useLimit,expire:t.expire}}var c=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i().post("/user/login",{username:t,password:n});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),l=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n,a){var o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i().post("/user/register",{username:t,password:n,retry_password:a});case 2:return o=e.sent,e.abrupt("return",o.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),s=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i().get("/file/list",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i().get("/user/list",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("\u8bf7\u6c42\u53c2\u6570",t),e.next=3,i().post("/user/share",t,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i().get("/file/share",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i().get("/file/be-share",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i().get("/file/download?filename=".concat(t,"&state=").concat(n),{responseType:"blob",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),g=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i().post("/admin/upload",t,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i().get("/file/shareDelete?id=".concat(t),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}]);
//# sourceMappingURL=291.9f7b3983.chunk.js.map