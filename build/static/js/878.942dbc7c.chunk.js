"use strict";(self.webpackChunkwebfile=self.webpackChunkwebfile||[]).push([[878],{5180:function(e,n,t){t.r(n),t.d(n,{default:function(){return T}});var i=t(2791),s=t(6871),a=t(2639),r=t(9505),o=t(4005),c=t(1413),l=t(9439),f=t(8830),u=t(1914);function m(){var e=(0,o.oR)(u.v),n=(0,o.oR)(f.c),t=(0,i.useState)([]),s=(0,l.Z)(t,2),a=s[0],r=s[1];return(0,c.Z)((0,c.Z)((0,c.Z)({},e),n),{},{files:a,setFiles:r})}var d=t(3456),p=t(8953),Z=t(7442),x=t(4350),h=t(3767),k=t(4554),j=t(1186),w=t(9377),g=t(3857),S=t(7209),v=t(3195),B=t(184),z=function(e){var n=e.fileName,t=e.onOperationClicked;return(0,B.jsx)(h.Z,{m:1,children:(0,B.jsxs)(k.Z,{borderRadius:3,children:[(0,B.jsx)(x.Z,{fileName:n}),(0,B.jsx)(Z.Z,{title:"\u6587\u4ef6\u64cd\u4f5c",children:(0,B.jsx)(r.Z,{items:[(0,B.jsx)(j.Z,{icon:(0,B.jsx)(w.Z,{fontSize:"large"}),name:"\u6253\u5f00",onclick:function(){return t("open")}}),(0,B.jsx)(j.Z,{icon:(0,B.jsx)(g.Z,{fontSize:"large"}),name:"\u5171\u4eab",onclick:function(){return t("share")}}),(0,B.jsx)(j.Z,{icon:(0,B.jsx)(S.Z,{fontSize:"large"}),name:"\u5220\u9664",onclick:function(){return t("delete")}})]})}),(0,B.jsx)(Z.Z,{title:"\u66f4\u591a\u64cd\u4f5c",children:(0,B.jsx)(r.Z,{items:[(0,B.jsx)(j.Z,{icon:(0,B.jsx)(v.Z,{fontSize:"large"}),name:"\u8be6\u7ec6\u4fe1\u606f",onclick:function(){return t("detail")}})]})})]})})},O=t(627),D=t(1315),N=t(2479),b=t(2001),C=t(7471),R=t(7090),y=function(){var e,n=(0,s.s0)(),t=(0,o.oR)(m),c=(0,o.oR)(C.D),l=(0,o.oR)(p.i);(0,i.useEffect)((function(){(0,D.v3)().then((function(e){e&&200===e.code&&(Array.isArray(e.data)?(t.setFiles(e.data.map((function(e,n){return{id:e.id,fileName:e.fileName,fileSize:e.fileSize,state:"fromShared",target:e.target,use:e.use,useLimit:e.useLimit,expire:e.expire,isAllow:e.isAllow}}))),t.setLoading(!1)):t.setFiles([e.data]))}))}),[]);var f=function(e){var i=t.files[e].useLimit-t.files[e].use;console.log("\u6587\u4ef6\u8fc7\u671f\u65f6\u95f4",t.files[e].expire),console.log("\u5f53\u524d\u65f6\u95f4",(new Date).getTime()),t.files[e].expire<(new Date).getTime()?R.Z.warning("\u8be5\u6587\u4ef6\u5df2\u8fc7\u671f\uff0c\u8bf7\u8054\u7cfb\u75c5\u5386\u62e5\u6709\u8005"):i<=0?R.Z.warning("\u8be5\u6587\u4ef6\u5df2\u88ab\u4f7f\u7528\u5b8c\u6bd5\uff0c\u8bf7\u8054\u7cfb\u6587\u4ef6\u62e5\u6709\u8005"):(l.setBottomDrawerOpen(!0),l.setBottomDrawerContent((0,B.jsx)(z,{fileName:t.files[e].fileName,onOperationClicked:function(i){return function(e,i){switch(e){case"delete":l.setBottomDrawerOpen(!1),(0,D.SN)(t.files[i].id).then((function(e){e&&200==e.code?(c.setSnackBarMessage("\u75c5\u5386\u5171\u4eab\u8bb0\u5f55\u5220\u9664\u6210\u529f"),c.setSnackBarOpen(!0),c.setSnackBarType("success")):(c.setSnackBarMessage("\u5220\u9664\u5931\u8d25,".concat(e.message)),c.setSnackBarOpen(!0),c.setSnackBarType("warning"))})).catch((function(e){c.setSnackBarMessage("\u5220\u9664\u5931\u8d25,".concat(e)),c.setSnackBarOpen(!0),c.setSnackBarType("error")})),n("/fileshare");break;case"share":if(l.setBottomDrawerOpen(!1),1!=t.files[i].isAllow){R.Z.warning("\u5f53\u524d\u75c5\u5386\u5e76\u672a\u5206\u914d\u5171\u4eab\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u5171\u4eab\u6765\u6e90\u7528\u6237");break}n("/policymanage/create",{state:t.files[i]});break;case"open":l.setBottomDrawerOpen(!1),n("/pdfpreview",{state:(0,D.RX)(i,t.files[i])});break;case"detail":l.setBottomDrawerOpen(!1),n("/fileshare/details",{state:t.files[i]})}}(i,e)}})))};return(0,B.jsx)(O.Z,{in:!0,children:(0,B.jsx)(k.Z,{children:(0,B.jsx)(r.Z,{items:null===(e=t.files)||void 0===e?void 0:e.map((function(e,n){return(0,B.jsx)(a.Z,{fileName:e.fileName,fileTime:(0,N.u)(e.expire),fileSize:(0,b.N)(e.fileSize),remainUse:e.useLimit-e.use,sharedContent:(0,B.jsx)(d.Z,{state:"shared"}),onOperationClicked:function(){return f(n)}},n)})),onItemClicked:f})})})},T=function(){return(0,B.jsx)(o.zt,{of:m,children:(0,B.jsx)(y,{})})}},7209:function(e,n,t){var i=t(2791),s=t(8499);n.Z=(0,s.Z)(i.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete")}}]);
//# sourceMappingURL=878.942dbc7c.chunk.js.map